openapi: 3.0.0
info:
  description: >-
    This is the API spec for the vehicle microservice. Endpoints and parameters
    only exist for the operations getVehicle and getTechRecords. Other
    operations within the microservice are out of scope.
  version: 1.0.0
  title: Vehicles Microservice
  termsOfService: ''
  contact:
    email: bpecete@deloittece.com
  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
tags:
  - name: getTechRecords
    description: >-
      Endpoints to retrieve one or more tech records. Currently we only need one
      endpoint to retrieve the current tech record of a single vehicle.
    externalDocs:
      description: Find out more
      url: 'https://wiki.i-env.net/display/HVT/Epic%3A+View+vehicle+details'
  - name: updateTechRecords
    description: >-
      Endpoint to update the tech record of a single vehicle. When updating the
      tech record, the previous one is archived and a new one with status
      'current' is created
paths:
  '/vehicles/{searchIdentifier}/tech-records':
    get:
      summary: 'Get a tech record, for a particular Vin with status specified.'
      tags:
        - getTechRecords
      parameters:
        - in: path
          name: searchIdentifier
          schema:
            type: string
            minLength: 3
            maxLength: 21
          required: true
          description: >-
            If the searchCriteria query parameter is not used or it has the "all"
            value then the searchIdentifier can be VRM, VIN, last six digits of
            the VIN or trailerId. VRM = between 3 and 8 characters, VIN = >8 characters,
            partial VIN = exactly 6 digits and trailerId = exactly 8 digits / 1 letter
            followed by exactly 6 digits.
        - in: query
          name: metadata
          schema:
            type: boolean
            description: >-
              Applicable only to ADR details. Query param for returning the list
              of values that are selectable on the front end, for the fields
              that are strings in the back end, due to the lack of data cleansing
              done for the migration. If "metadata" = "true" then GET will send
              back the metadata object, otherwise metadata object will not be returned.
        - in: query
          name: status
          schema:
            type: string
            default: provisional_over_current
            enum:
              - archived
              - current
              - provisional
              - provisional_over_current
              - all
          description: >-
            The tech record's status, the default value is
            provisional_over_current. If "status" = "provisional_over_current"
            or not provided when the GET call is done, then the current tech
            record will be retrieved only if, for the "searchIdentifier" that
            was provided, there is no "provisional" tech record, in which case
            the provisional tech record will be retrieved instead. If "status" =
            "all", then the backend will translate this into returning ALL
            technical records for that particular VIN/VRM, not just specific
            statuses
        - in: query
          name: searchCriteria
          schema:
            type: string
            default: all
            enum:
              - all
              - vin
              - vrm
              - partialVin
              - trailerId
          description: >-
            The parameter is used to specify which search criteria
            should be used. "ALL" = search identifier can be VRM, VIN, last six
            digits of the VIN or trailerId. VRM = between 3 and 8 characters,
            VIN = >8 characters, partial VIN = exactly 6 digits and trailerId =
            exactly 8 digits / 1 letter followed by exactly 6 digits. If any
            other value than "ALL" is used then the search will be done using the
            specified search criteria, without taking into account the format of the saerch identifier.
      operationId: getTechRecords
      responses:
        '200':
          description: Tech record returned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/completeTechRecords'
        '401':
          description: Not authenticated
        '403':
          description: Unauthorised Access
        '404':
          description: Operation not supported
  '/vehicles/{systemNumber}':
    put:
      summary: 'Update a tech record, for a particular systemNumber'
      tags:
        - updateTechRecords
      parameters:
        - in: path
          name: systemNumber
          schema:
            type: string
          required: true
          description: This represents the systemNumber of the vehicle
        - in: query
          name: oldStatusCode
          schema:
            type: string
          required: false
          description: This represents the old statusCode of a techRecord. Should be passed only if the statusCode was changed.
      requestBody:
        required: true
        description: The tech record to update
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/techRecordPUT'
      operationId: updateTechRecords
      responses:
        '200':
          description: Returns the updated tech record
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/completeTechRecordPUT'
        '400':
          description: Bad request
        '401':
          description: Not authenticated
        '403':
          description: Unauthorised Access
        '404':
          description: Operation not supported
        '422':
          description: Unprocessable request
        '500':
          description: Validation Error
  '/vehicles/add-provisional/{systemNumber}':
    post:
      summary: 'Creates a new tech-record with status provisional for that vehicle and appends it to the techRecords array'
      tags:
        - addProvisionalTechRecord
      parameters:
        - in: path
          name: systemNumber
          schema:
            type: string
          required: true
          description: This represents the systemNumber of the vehicle
      requestBody:
        required: true
        description: The tech record to be created and added into the techRecords array
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/techRecordArchiveAndProvisionalPayload'
      operationId: addProvisionalTechRecord
      responses:
        '200':
          description: Returns the updated tech record
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/completeTechRecordPUT'
        '400':
          description: Bad request
        '401':
          description: Not authenticated
        '403':
          description: Unauthorised Access
        '404':
          description: Operation not supported
        '422':
          description: Unprocessable request
        '500':
          description: Validation Error
  '/vehicles/archive/{systemNumber}':
    post:
      summary: 'Archive an existing current or provisional tech record'
      tags:
        - archiveTechRecordStatus
      parameters:
        - in: path
          name: systemNumber
          schema:
            type: string
          required: true
          description: This represents the systemNumber of the vehicle
      requestBody:
        required: true
        description: The tech record to be archived
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/techRecordArchiveAndProvisionalPayload'
      operationId: archiveTechRecordStatus
      responses:
        '200':
          description: Returns the updated tech record
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/completeTechRecordPUT'
        '400':
          description: Bad request
        '401':
          description: Not authenticated
        '403':
          description: Unauthorised Access
        '404':
          description: Operation not supported
        '422':
          description: Unprocessable request
        '500':
          description: Validation Error
  '/vehicles':
    post:
      summary: 'Create a tech record'
      tags:
        - postTechRecords
      requestBody:
        required: true
        description: The tech record to create
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/techRecordPOST'
      operationId: postTechRecords
      responses:
        '200':
          description: Returns the message 'Technical Record created'
          content:
            application/text:
              example: Technical Record created
        '400':
          description: Bad request
        '401':
          description: Not authenticated
        '403':
          description: Unauthorised Access
        '404':
          description: Operation not supported
        '422':
          description: Unprocessable request
        '500':
          description: Validation Error
  '/vehicles/{vin}':
    post:
      summary: 'Amend vin'
      tags:
        - amendVin
      parameters:
        - in: path
          name: vin
          schema:
            type: string
          required: true
          description: Vehicle identification number
      requestBody:
        required: true
        description: The new VIN
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/amendTechRecordVinPost'
      operationId: amendVin
      responses:
        '200':
          description: OK
          content:
            text/plain:
              schema:
                type: string
                example: OK
        '400':
          description: Bad request
        '401':
          description: Not authenticated
        '403':
          description: Unauthorised Access
        '404':
          description: Operation not supported
        '500':
          description: Validation Error
components:
  securitySchemes:
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: 'https://example.com/oauth/authorize'
          tokenUrl: 'https://example.com/oauth/token'
          scopes:
            read: Grants read access
            write: Grants write access
  schemas:
    completeTechRecords:
      type: array
      items:
        $ref: '#/components/schemas/completeTechRecord'
    completeTechRecord:
      type: object
      properties:
        systemNumber:
          type: string
          description: It defines the composed primary key, in combination with "vin".
        vrms:
          $ref: '#/components/schemas/vrms'
        vin:
          type: string
          minLength: 1
          maxLength: 21
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle'
        trailerId:
          type: string
          maxLength: 8
          description: Used only for TRL
        techRecord:
          $ref: '#/components/schemas/techRecords'
        metadata:
          $ref: '#/components/schemas/metadata'
    vrms:
      type: array
      items:
        $ref: '#/components/schemas/vrm'
    metadata:
      type: object
      nullable: true
      description: Applicable only to ADR details. Returned only if query param "metadata" = "true", otherwise not returned
      properties:
        makeAndChassisMakeFe:
          type: array
          description: makeFe and chassisMakeFe fields have the same value. Combining them into a field for now so we don't send the same list twice.
          items:
            type: string
        bodyMakeFe:
          type: array
          items:
            type: string
        adrDetails:
          type: object
          properties:
            memosApplyFe:
              type: array
              items:
                type: string
                enum:
                  - 07/09 3mth leak ext
            tank:
              type: object
              properties:
                tankStatement:
                  type: object
                  properties:
                    substancesPermittedFe:
                      type: array
                      items:
                        type: string
                        enum:
                          - 'Substances permitted under the tank
                            code and any special provisions
                            specified in 9 may be carried'
                          - 'Substances (Class UN number and if
                            necessary packing group and proper shipping
                            name) may be carried'
            additionalNotes:
              type: object
              properties:
                guidanceNotesFe:
                  type: array
                  items:
                    type: string
                    enum:
                      - New certificate requested
                numberFe:
                  type: array
                  items:
                    type: string
                    enum:
                      - '1'
                      - '1A'
                      - '2'
                      - '3'
                      - 'V1B'
                      - 'T1B'
            permittedDangerousGoodsFe:
              type: array
              items:
                type: string
                enum:
                  - FP <61 (FL)
                  - AT
                  - Class 5.1 Hydrogen Peroxide (OX)
                  - MEMU
                  - Carbon Disulphide
                  - Hydrogen
                  - Explosives (type 2)
                  - Explosives (type 3)
            vehicleDetails:
              type: object
              properties:
                typeFe:
                  type: array
                  items:
                    type: string
                    enum:
                      - Artic tractor
                      - Rigid box body
                      - Rigid sheeted load
                      - Rigid tank
                      - Rigid skeletal
                      - Rigid battery
                      - Full drawbar box body
                      - Full drawbar sheeted load
                      - Full drawbar tank
                      - Full drawbar skeletal
                      - Full drawbar battery
                      - Centre axle box body
                      - Centre axle sheeted load
                      - Centre axle tank
                      - Centre axle skeletal
                      - Centre axle battery
                      - Semi trailer box body
                      - Semi trailer sheeted load
                      - Semi trailer tank
                      - Semi trailer skeletal
                      - Semi trailer battery
    vrm:
      type: object
      description: Used only for PSV and HGV
      properties:
        vrm:
          type: string
          minLength: 1
          maxLength: 8
        isPrimary:
          type: boolean
    techRecordArchiveAndProvisionalPayload:
      type: object
      properties:
        msUserDetails:
          type: object
          properties:
            msUser:
              type: string
            msOid:
              type: string
        techRecord:
          $ref: '#/components/schemas/techRecord'
    techRecordPUT:
      type: object
      properties:
        msUserDetails:
          type: object
          properties:
            msUser:
              type: string
            msOid:
              type: string
        primaryVrm:
          type: string
          minLength: 3
          maxLength: 8
          description: Mandatory for PSV, HGV, car, lgv, motorcycle. Optional for TRL
        secondaryVrms:
          type: array
          items:
            type: string
            minLength: 3
            maxLength: 8
          description: Mandatory for PSV and HGV. Optional for TRL
        trailerId:
          type: string
          maxLength: 8
          description: Used only for TRL. Optional for HGV and PSV
        techRecord:
          $ref: '#/components/schemas/techRecords'
    techRecordPOST:
      type: object
      properties:
        msUserDetails:
          type: object
          properties:
            msUser:
              type: string
            msOid:
              type: string
        vin:
          type: string
          minLength: 3
          maxLength: 21
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle'
        primaryVrm:
          type: string
          minLength: 3
          maxLength: 8
          description: Mandatory for PSV, HGV, car, lgv, motorcycle. Optional for TRL
        secondaryVrms:
          type: array
          items:
            type: string
            minLength: 3
            maxLength: 8
          description: Mandatory for PSV and HGV. Optional for TRL
        trailerId:
          type: string
          maxLength: 8
          description: Used only for TRL. Optional for HGV and PSV
        techRecord:
          $ref: '#/components/schemas/techRecords'
    completeTechRecordPUT:
      type: object
      properties:
        systemNumber:
          type: string
          description: It defines the composed primary key, in combination with "vin".
        vrms:
          $ref: '#/components/schemas/vrms'
        vin:
          type: string
          minLength: 1
          maxLength: 21
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle'
        trailerId:
          type: string
          maxLength: 8
          description: Used only for TRL
        techRecord:
          $ref: '#/components/schemas/techRecords'
    techRecords:
      type: array
      items:
        $ref: '#/components/schemas/techRecord'
    techRecord:
      type: object
      properties:
        recordCompleteness:
          type: string
          description: Defines the level of completeness for a tech record. If it is set to "skeleton" then it means the vehicle does not meet the minimum requirements to be tested. If it is "testable" it means the vehicle meets the minimum requirements to be tested but is not complete from a business perspective. If "complete" then the vehicle it is complete form a business perspective also.
        createdAt:
          type: string
          format: date-time
          description: 'Used for all vehicle types'
        lastUpdatedAt:
          type: string
          format: date-time
          description: 'Used for all vehicle types'
        make:
          type: string
          maxLength: 30
          description: Used only for HGV and TRL
        model:
          type: string
          maxLength: 30
          description: Used only for HGV and TRL
        functionCode:
          type: string
          maxLength: 1
          description: Used for all vehicle types
          nullable: true
        fuelPropulsionSystem:
          type: string
          description: Used for HGV and PSV
          enum:
            - DieselPetrol
            - Hybrid
            - Electric
            - CNG
            - Fuel cell
            - LNG
            - Other
        offRoad:
          type: boolean
          description: Used only for HGV
        numberOfWheelsDriven:
          type: number
          maximum: 9999
          description: Used for motorcycles to derive the test codes for specialist tests. Used for HGV and PSV.
        euVehicleCategory:
          type: string
          description: Used for all vehicle types. Optional for car, lgv and motorcycle.
          enum:
            - m1
            - m2
            - m3
            - n1
            - n2
            - n3
            - o1
            - o2
            - o3
            - o4
            - l1e-a
            - l1e
            - l2e
            - l3e
            - l4e
            - l5e
            - l6e
            - l7e
        emissionsLimit:
          type: number
          description: Used only for HGV and PSV
          maximum: 99
          nullable: true
        departmentalVehicleMarker:
          type: boolean
          nullable: true
          description: Used for all vehicle types
        authIntoService:
          $ref: '#/components/schemas/authIntoService'
        lettersOfAuth:
          $ref: '#/components/schemas/lettersOfAuth'
        alterationMarker:
          type: boolean
          nullable: true
          description: Used for all vehicle types
        approvalType:
          type: string
          description: Used for all vehicle types
          enum:
            - NTA
            - ECTA
            - IVA
            - NSSTA
            - ECSSTA
        approvalTypeNumber:
          description: Used for all vehicle types
          type: string
          maxLength: 25
          nullable: true
        variantNumber:
          type: string
          maxLength: 25
          nullable: true
          description: Used for all vehicle types
        variantVersionNumber:
          type: string
          maxLength: 35
          nullable: true
          description: Used for all vehicle types
        grossEecWeight:
          type: number
          maximum: 99999
          nullable: true
          description: Used only for HGV and TRL
        trainEecWeight:
          type: number
          maximum: 99999
          nullable: true
          description: Used only for HGV
        maxTrainEecWeight:
          type: number
          maximum: 99999
          nullable: true
          description: Used only for HGV
        applicantDetails:
          $ref: '#/components/schemas/applicantDetailsProperties'
        purchaserDetails:
          $ref: '#/components/schemas/purchaserDetails'
        manufacturerDetails:
          $ref: '#/components/schemas/manufacturerDetails'
        microfilm:
          $ref: '#/components/schemas/microfilm'
        plates:
          $ref: '#/components/schemas/plates'
        chassisMake:
          type: string
          maxLength: 20
          description: Used only for PSV
        chassisModel:
          type: string
          maxLength: 20
          description: Used only for PSV
        bodyMake:
          type: string
          maxLength: 20
          description: Used only for PSV
        bodyModel:
          type: string
          maxLength: 20
          description: Used only for PSV
        modelLiteral:
          type: string
          maxLength: 30
          nullable: true
          description: Used only for PSV
        bodyType:
          type: object
          properties:
            code:
              type: string
              enum:
                - a
                - s
                - d
                - o
                - m
                - x
                - p
                - k
                - t
                - b
                - f
                - r
                - c
                - e
                - y
                - m
                - i
                - a
                - u
                - l
            description:
              type: string
              enum:
                - articulated
                - single decker
                - double decker
                - other
                - other tanker
                - petrol/oil tanker
                - skeletal
                - tipper
                - box
                - flat
                - refuse
                - skip loader
                - refrigerated
                - curtainsider
                - car transporter
                - concrete mixer
                - mini bus
                - livestock carrier
                - fast trac tractor
                - artic unit
                - low loader
          description: >-
            Used for all vehicles types - PSV, HGV and TRL. x = other, d = double decker.
            Used only for HGV and TRL. p = petrol/oil tanker, o = other tanker, s = skip loader, f = flat,
            c = refrigerated, b = box, e = curtainsider, k = skeletal, t = tipper, y = car transporter, i =
            livestock carrier.
            Used only for HGV. r = refuse, m = concrete mixer, a = fast trac tractor, u = artic unit.
            Used only for PSV. s = single decker, a = articulated, m = mini bus.
            Used only for TRL. l = low loader.
        manufactureYear:
          type: number
          maximum: 9999
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle'
        regnDate:
          type: string
          format: date
          nullable: true
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle'
        firstUseDate:
          type: string
          format: date
          nullable: true
          description: 'Used for all vehicle types - PSV, HGV and TRL'
        coifDate:
          type: string
          format: date
          description: Used only for PSV
          nullable: true
        ntaNumber:
          type: string
          maxLength: 40
          description: 'Used for all vehicle types - PSV, HGV and TRL'
          nullable: true
        coifSerialNumber:
          description: Used only for PSV
          type: string
          maxLength: 8
          nullable: true
        coifCertifierName:
          description: Used only for PSV
          type: string
          maxLength: 20
          nullable: true
        conversionRefNo:
          type: string
          maxLength: 10
          description: 'Used for all vehicle types - PSV, HGV and TRL'
          nullable: true
        seatsLowerDeck:
          type: number
          maximum: 999
          description: Used only for PSV
        seatsUpperDeck:
          type: number
          maximum: 99
          description: Used only for PSV
        standingCapacity:
          type: number
          maximum: 999
          description: Used only for PSV
        speedRestriction:
          type: number
          maximum: 99
          description: Used only for PSV
          nullable: true
        speedLimiterMrk:
          type: boolean
          description: Used only for PSV and HGV
        tachoExemptMrk:
          type: boolean
          description: Used only for PSV and HGV
        dispensations:
          type: string
          maxLength: 160
          nullable: true
          description: Used only for PSV
        remarks:
          type: string
          maxLength: 1024
          nullable: true
          description: Used for PSV, car, lgv and motorcycle
        reasonForCreation:
          type: string
          maxLength: 100
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv and motorcycle'
        statusCode:
          type: string
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle'
          enum:
            - archived
            - current
            - provisional
        unladenWeight:
          type: number
          maximum: 99999
          description: Used only for PSV
        grossKerbWeight:
          type: number
          maximum: 99999
          description: Used only for PSV
        grossLadenWeight:
          type: number
          maximum: 99999
          description: Used only for PSV
        grossGbWeight:
          type: number
          maximum: 99999
          description: 'Used for all vehicle types - PSV, HGV and TRL'
        grossDesignWeight:
          type: number
          maximum: 99999
          description: 'Used for all vehicle types - PSV, HGV and TRL'
        trainGbWeight:
          type: number
          maximum: 99999
          description: Used only for HGV
        trainDesignWeight:
          type: number
          maximum: 99999
          description: Used only for HGV and PSV
          nullable: true
        maxTrainGbWeight:
          type: number
          maximum: 99999
          description: Used only for HGV and PSV. Optional for PSV
        maxTrainDesignWeight:
          type: number
          maximum: 99999
          description: Used only for HGV
          nullable: true
        maxLoadOnCoupling:
          type: number
          maximum: 99999
          description: Used only for TRL
          nullable: true
        frameDescription:
          type: string
          nullable: true
          enum:
            - Channel section
            - Space frame
            - I section
            - Tubular
            - Frame section
            - Other
            - integral
            - Box section
            - U section
        tyreUseCode:
          type: string
          maxLength: 2
          description: Used only for HGV and TRL
          nullable: true
        roadFriendly:
          type: boolean
          description: Used only for HGV and TRL
        drawbarCouplingFitted:
          type: boolean
          description: Used only for HGV
        euroStandard:
          type: string
          description: Used for HGV and PSV
        suspensionType:
          type: string
          maxLength: 1
          description: Used only for TRL
          nullable: true
        couplingType:
          type: string
          maxLength: 1
          description: Used only for TRL
          nullable: true
        dimensions:
          type: object
          properties:
            length:
              type: number
              maximum: 99999
              description: Used for all vehicle types. Optional for PSV
            height:
              type: number
              maximum: 99999
              description: Used only for PSV
              nullable: true
            width:
              type: number
              maximum: 99999
              description: Used for all vehicle types. Optional for PSV
            axleSpacing:
              type: array
              description: Used only for HGV and TRL
              items:
                type: object
                properties:
                  axles:
                    type: string
                    nullable: true
                  value:
                    type: number
                    maximum: 99999
                    description: Optional for HGV
        frontAxleTo5thWheelMin:
          type: number
          maximum: 99999
          nullable: true
          description: Used only for HGV
        frontAxleTo5thWheelMax:
          type: number
          maximum: 99999
          nullable: true
          description: Used only for HGV
        frontAxleTo5thWheelCouplingMin:
          type: number
          maximum: 99999
          description: Used only for HGV. Optional for HGV
        frontAxleTo5thWheelCouplingMax:
          type: number
          maximum: 99999
          description: Used only for HGV. Optional for HGV
        frontAxleToRearAxle:
          type: number
          maximum: 99999
          description: Used for all vehicle types. Optional for PSV
        rearAxleToRearTrl:
          type: number
          maximum: 99999
          description: Used only for TRL
        couplingCenterToRearAxleMin:
          type: number
          maximum: 99999
          description: Used only for TRL
        couplingCenterToRearAxleMax:
          type: number
          maximum: 99999
          description: Used only for TRL
        couplingCenterToRearTrlMin:
          type: number
          maximum: 99999
          description: Used only for TRL
        couplingCenterToRearTrlMax:
          type: number
          maximum: 99999
          description: Used only for TRL
        centreOfRearmostAxleToRearOfTrl:
          type: number
          maximum: 99999
          description: Used only for TRL
        notes:
          type: string
          description: Used only for HGV and TRL
          nullable: true
        noOfAxles:
          type: number
          maximum: 99
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle'
        brakeCode:
          type: string
          maxLength: 6
          description: Used only for PSV
        adrDetails:
          $ref: '#/components/schemas/adrDetails'
        createdByName:
          type: string
          nullable: true
          description: >-
            This field gets populated with the Microsoft AD 'name', when a tech record gets created
        createdById:
          type: string
          nullable: true
          description: >-
            This attribute gets populated with the Microsoft AD 'oid', when a tech record gets created
        lastUpdatedByName:
          type: string
          description: >-
            This field gets populated with the Microsoft AD 'name', when a tech record gets updated
        lastUpdatedById:
          type: string
          description: >-
            This attribute gets populated with the Microsoft AD 'oid', when a tech record gets updated
        updateType:
          type: string
          enum:
            - adrUpdate
            - techRecordUpdate
          description: >-
            set updateType to adrUpdate on the archived tech record, when a tech record is archived
        vehicleClass:
          type: object
          properties:
            code:
              type: string
              nullable: true
              enum:
                - '2'
                - 'n'
                - 's'
                - '1'
                - 't'
                - 'l'
                - '3'
                - 'v'
                - '4'
                - '7'
                - '5'
            description:
              type: string
              enum:
                - 'motorbikes over 200cc or with a sidecar'
                - 'not applicable'
                - 'small psv (ie: less than or equal to 22 seats)'
                - 'motorbikes up to 200cc'
                - 'trailer'
                - 'large psv(ie: greater than 23 seats)'
                - '3 wheelers'
                - 'heavy goods vehicle'
                - 'MOT class 4'
                - 'MOT class 7'
                - 'MOT class 5'
                - 'PSV of unknown or unspecified size'
                - 'Not Known'
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle. Optional for CAR and LGV'
        vehicleSubclass:
          type: array
          items:
            type: string
          nullable: true
          description: Used for car and lgv.
        vehicleType:
          type: string
          enum:
            - psv
            - hgv
            - trl
            - car
            - lgv
            - motorcycle
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle'
        vehicleSize:
          type: string
          enum:
            - small
            - large
          description: Used only for PSV
        numberOfSeatbelts:
          type: string
          maxLength: 99
          description: Used only for PSV
        seatbeltInstallationApprovalDate:
          type: string
          nullable: true
          description: Used only for PSV
        vehicleConfiguration:
          type: string
          enum:
            - rigid
            - articulated
            - centre axle drawbar
            - semi-car transporter
            - semi-trailer
            - long semi-trailer
            - low loader
            - other
            - drawbar
            - four-in-line
            - dolly
            - full drawbar
          description: 'Used for all vehicle types - PSV, HGV and TRL'
        brakes:
          $ref: '#/components/schemas/brakes'
        axles:
          $ref: '#/components/schemas/axles'
        dda:
          $ref: '#/components/schemas/dda'
    adrDetails:
      type: object
      nullable: true
      description: Used only for HGV and TRL
      properties:
        vehicleDetails:
          type: object
          properties:
            type:
              type: string
              description: >-
                Mandatory. Users must select ONE of these. Users cannot select
                less/more
            approvalDate:
              type: string
              description: Date (YYYY-MM-DD)
              format: date
        listStatementApplicable:
          type: boolean
          description: >-
            Optional. Applicable only if vehicleDetails.type contains the word ‘battery’.
        batteryListNumber:
          type: string
          maxLength: 8
          description: >-
            Mandatory if listStatementApplicable is true, therefore applicable only if vehicleDetails.type contains the word ‘battery’. Else N/A
        declarationsSeen:
          type: boolean
          nullable: true
          description: Optional for all vehicle types
        brakeDeclarationsSeen:
          type: boolean
          nullable: true
          description: Optional for all vehicle types
        brakeDeclarationIssuer:
          type: string
          nullable: true
          description: Optional for all vehicle types
        brakeEndurance:
          type: boolean
          nullable: true
          description: Optional for all vehicle types
        weight:
          type: string
          maxLength: 8
          description: >-
            Mandatory if brakeEndurance = true, else N/A
        compatibilityGroupJ:
          type: boolean
          nullable: true
          description: Optional for all vehicle types
        documents:
          type: array
          items:
            type: string
          description: >-
            Optional. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
        permittedDangerousGoods:
          type: array
          description: >-
            Mandatory. Users must select, AT LEAST ONE of these. However, users
            CAN select more than one
          items:
            type: string
        additionalExaminerNotes:
          type: string
          maxLength: 1024
          description: Optional for all vehicle types
          nullable: true
        applicantDetails:
          type: object
          properties:
            name:
              type: string
              maxLength: 150
            street:
              type: string
              maxLength: 150
            town:
              type: string
              maxLength: 100
            city:
              type: string
              maxLength: 100
            postcode:
              type: string
              maxLength: 25
        memosApply:
          type: array
          items:
            type: string
            description: >-
              Optional. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
        additionalNotes:
          type: object
          properties:
            number:
              type: array
              nullable: true
              description: Optional for all vehicle types
              items:
                type: string
            guidanceNotes:
              type: array
              nullable: true
              description: Optional for all vehicle types
              items:
                type: string
        adrTypeApprovalNo:
          type: string
          nullable: true
        adrCertificateNotes:
          type: string
          nullable: true
          maxLength: 1500
        tank:
          type: object
          nullable: true
          properties:
            tankDetails:
              type: object
              properties:
                tankManufacturer:
                  type: string
                  maxLength: 70
                  description: >-
                    Mandatory. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                yearOfManufacture:
                  type: number
                  maximum: 2100
                  minimum: 1800
                  description: >-
                    Mandatory. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                tankCode:
                  type: string
                  maxLength: 30
                  description: >-
                    Mandatory. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                specialProvisions:
                  type: string
                  maxLength: 1024
                  nullable: true
                  description: >-
                    Optional. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                tankManufacturerSerialNo:
                  type: string
                  maxLength: 50
                  description: >-
                    Mandatory. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                tankTypeAppNo:
                  type: string
                  maxLength: 30
                  description: >-
                    Optional. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                tc2Details:
                  type: object
                  properties:
                    tc2Type:
                      type: string
                      description: >-
                        Optional. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                      enum:
                        - initial
                    tc2IntermediateApprovalNo:
                      type: string
                      maxLength: 70
                      description: >-
                        Optional. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                    tc2IntermediateExpiryDate:
                      type: string
                      format: date
                      description: >-
                        Optional. Date(YYYY-MM-DD). Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                tc3Details:
                  type: array
                  items:
                    type: object
                    properties:
                      tc3Type:
                        type: string
                        description: >-
                          Optional. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                        enum:
                          - intermediate
                          - periodic
                          - exceptional
                      tc3PeriodicNumber:
                        type: string
                        maxLength: 75
                        description: >-
                          Optional. Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
                      tc3PeriodicExpiryDate:
                        type: string
                        format: date
                        description: >-
                          Optional. Date(YYYY-MM-DD). Applicable only if vehicleDetails.type contains the word ‘tank’ or ‘battery’.
            tankStatement:
              type: object
              properties:
                substancesPermitted:
                  type: string
                  description: >-
                    Mandatory IF vehicleDetails.type contains the word ‘tank’ or ‘battery’ ELSE, optional. If mandatory, users must select ONE of
                    these. Users cannot select less/more than one
                statement:
                  type: string
                  nullable: true
                  maxLength: 1500
                  description: >-
                    Optional. Applicable only IF vehicleDetails.type contains the word ‘tank’ or ‘battery’
                productListRefNo:
                  type: string
                  nullable: true
                  description: >-
                    Optional. Applicable only IF vehicleDetails.type contains the word ‘tank’ or ‘battery’
                productListUnNo:
                  type: array
                  nullable: true
                  description: 'Optional. Applicable only IF vehicleDetails.type contains the word ‘tank’ or ‘battery’'
                  items:
                    type: string
                productList:
                  type: string
                  maxLength: 1500
                  description: >-
                    Optional. Applicable only IF vehicleDetails.type contains the word ‘tank’ or ‘battery’
                  nullable: true
    brakes:
      type: object
      properties:
        brakeCodeOriginal:
          type: string
          maxLength: 3
          description: Used only for PSV
        brakeCode:
          type: string
          maxLength: 6
          description: Used only for PSV
        dataTrBrakeOne:
          type: string
          maxLength: 60
          description: Used only for PSV
        dataTrBrakeTwo:
          type: string
          maxLength: 60
          description: Used only for PSV
        dataTrBrakeThree:
          type: string
          maxLength: 60
          description: Used only for PSV
        retarderBrakeOne:
          type: string
          nullable: true
          enum:
            - electric
            - exhaust
            - friction
            - hydraulic
            - other
            - none
          description: Used only for PSV
        retarderBrakeTwo:
          type: string
          nullable: true
          enum:
            - electric
            - exhaust
            - friction
            - hydraulic
            - other
            - none
          description: Used only for PSV
        dtpNumber:
          type: string
          maxLength: 6
          description: 'Used for PSV, HGV and TRL'
        brakeForceWheelsNotLocked:
          $ref: '#/components/schemas/brakeForceWheelsNotLocked'
        brakeForceWheelsUpToHalfLocked:
          $ref: '#/components/schemas/brakeForceWheelsUpToHalfLocked'
        loadSensingValve:
          type: boolean
          description: Used only for TRL
          nullable: true
        antilockBrakingSystem:
          type: boolean
          description: Used only for TRL
    brakeForceWheelsNotLocked:
      type: object
      properties:
        serviceBrakeForceA:
          type: number
          maximum: 99999
          description: Used only for PSV
        secondaryBrakeForceA:
          type: number
          maximum: 99999
          description: Used only for PSV
        parkingBrakeForceA:
          type: number
          maximum: 99999
          description: Used only for PSV
    brakeForceWheelsUpToHalfLocked:
      type: object
      properties:
        serviceBrakeForceB:
          type: number
          maximum: 99999
          description: Used only for PSV
        secondaryBrakeForceB:
          type: number
          maximum: 99999
          description: Used only for PSV
        parkingBrakeForceB:
          type: number
          maximum: 99999
          description: Used only for PSV
    axles:
      type: array
      items:
        $ref: '#/components/schemas/weights'
    weights:
      type: object
      properties:
        axleNumber:
          type: number
          maximum: 99999
          description: 'Used for all vehicle types - PSV, HGV and TRL'
        parkingBrakeMrk:
          type: boolean
          nullable: true
          description: 'Used for all vehicle types - PSV, HGV and TRL. Optional for HGV'
        weights:
          $ref: '#/components/schemas/axleWeightProperties'
        tyres:
          $ref: '#/components/schemas/axleTyreProperties'
        brakes:
          $ref: '#/components/schemas/axleBrakeProperties'
    axleWeightProperties:
      type: object
      properties:
        kerbWeight:
          type: number
          maximum: 99999
          description: Used only for PSV
        ladenWeight:
          type: number
          maximum: 99999
          description: Used only for PSV
        gbWeight:
          type: number
          maximum: 99999
          description: 'Used for all vehicle types - PSV, HGV and TRL'
        eecWeight:
          type: number
          maximum: 99999
          nullable: true
          description: Used only for HGV and TRL
        designWeight:
          type: number
          maximum: 99999
          description: 'Used for all vehicle types - PSV, HGV and TRL'
    plates:
      type: array
      nullable: true
      items:
        type: object
        properties:
          plateSerialNumber:
            type: string
            maxLength: 12
            nullable: true
            description: Used for all vehicle types
          plateIssueDate:
            type: string
            format: date
            nullable: true
            description: Used for all vehicle types
          plateReasonForIssue:
            type: string
            enum:
              - Free replacement
              - Replacement
              - Destroyed
              - Provisional
              - Original
              - Manual
            nullable: true
            description: Used for all vehicle types
          plateIssuer:
            type: string
            maxLength: 150
            nullable: true
            description: Used for all vehicle types
          toEmailAddress:
            type: string
            maxLength: 255
            nullable: true
            description: Used for all vehicle types
    microfilm:
      type: object
      properties:
        microfilmDocumentType:
          type: string
          nullable: true
          description: Used for all vehicle types
          enum:
            - PSV Miscellaneous
            - AAT - Trailer Annual Test
            - AIV - HGV International App
            - COIF Modification
            - Trailer COC + Int Plate
            - RCT - Trailer Test Cert paid
            - HGV COC + Int Plate
            - PSV Carry/Auth
            - OMO Report
            - AIT - Trailer International App
            - IPV - HGV EEC Plate/Cert
            - XCV - HGV Test Cert free
            - AAV - HGV Annual Test
            - COIF Master
            - Tempo 100 Sp Ord
            - Deleted
            - PSV N/ALT
            - XPT - Tr Plating Cert paid
            - FFV - HGV First Test
            - Repl Vitesse 100
            - TCV - HGV Test Cert
            - ZZZ -  Miscellaneous
            - Test Certificate
            - XCT - Trailer Test Cert free
            - C52 - COC and VTG52A
            - Tempo 100 Report
            - Main File Amendment
            - PSV Doc
            - PSV COC
            - PSV Repl COC
            - TAV - COC
            - NPT - Trailer Alteration
            - OMO Certificate
            - PSV Repl COIF
            - PSV Repl COF
            - COIF Application
            - XPV - HGV Plating Cert Free
            - TCT  - Trailer Test Cert
            - Tempo 100 App
            - PSV Decision on N/ALT
            - Special Order PSV
            - NPV - HGV Alteration
            - No Description Found
            - Vitesse 100 Sp Ord
            - Brake Test Details
            - COIF Productional
            - RDT - Test Disc Paid
            - RCV -  HGV Test Cert
            - FFT -  Trailer First Test
            - IPT - Trailer EEC Plate/Cert
            - XDT - Test Disc Free
            - PRV - HGV Plating Cert paid
            - COF Cert
            - PRT - Tr Plating Cert paid
            - Tempo 100 Permit
        microfilmRollNumber:
          type: string
          maxLength: 5
          nullable: true
          description: Used for all vehicle types
        microfilmSerialNumber:
          type: string
          maxLength: 4
          nullable: true
          description: Used for all vehicle types
    dda:
      type: object
      description: Disability Discrimination Act
      properties:
        certificateIssued:
          type: boolean
          description: Used only for PSV
        wheelchairCapacity:
          type: number
          maximum: 99
          nullable: true
          description: Used only for PSV
        wheelchairFittings:
          type: string
          maxLength: 250
          nullable: true
          description: Used only for PSV
        wheelchairLiftPresent:
          type: boolean
          nullable: true
          description: Used only for PSV
        wheelchairLiftInformation:
          type: string
          maxLength: 250
          nullable: true
          description: Used only for PSV
        wheelchairRampPresent:
          type: boolean
          nullable: true
          description: Used only for PSV
        wheelchairRampInformation:
          type: string
          maxLength: 250
          nullable: true
          description: Used only for PSV
        minEmergencyExits:
          type: number
          maximum: 99
          nullable: true
          description: Used only for PSV
        outswing:
          type: string
          maxLength: 250
          nullable: true
          description: Used only for PSV
        ddaSchedules:
          type: string
          maxLength: 250
          nullable: true
          description: Used only for PSV
        seatbeltsFitted:
          type: number
          maximum: 999
          nullable: true
          description: Used only for PSV
        ddaNotes:
          type: string
          maxLength: 1024
          nullable: true
          description: Used only for PSV
    authIntoService:
      type: object
      description: Authorization into service
      properties:
        cocIssueDate:
          type: string
          format: date
          nullable: true
          description: Used only for TRL
        dateReceived:
          type: string
          format: date
          nullable: true
          description: Used only for TRL
        datePending:
          type: string
          format: date
          nullable: true
          description: Used only for TRL
        dateAuthorised:
          type: string
          format: date
          nullable: true
          description: Used only for TRL
        dateRejected:
          type: string
          format: date
          nullable: true
          description: Used only for TRL
    lettersOfAuth:
      type: object
      description: Letters of authorisation
      properties:
        letterType:
          type: string
          nullable: true
          description: Used only for TRL
          enum:
            - Trailer authorization
            - Trailer rejection
        letterDateRequested:
          type: string
          format: date
          nullable: true
          description: Used only for TRL
        letterContents:
          type: string
          nullable: true
          description: Used only for TRL
    applicantDetailsProperties:
      type: object
      description: Used for all vehicle types
      properties:
        name:
          type: string
          maxLength: 150
        address1:
          type: string
          maxLength: 60
        address2:
          type: string
          maxLength: 60
        postTown:
          type: string
          maxLength: 60
        address3:
          type: string
          maxLength: 60
          nullable: true
        postCode:
          type: string
          maxLength: 12
          nullable: true
        emailAddress:
          type: string
          maxLength: 255
          nullable: true
        telephoneNumber:
          type: string
          maxLength: 25
          nullable: true
    purchaserDetails:
      type: object
      description: Used for TRL only
      properties:
        name:
          type: string
          maxLength: 150
        address1:
          type: string
          maxLength: 60
        address2:
          type: string
          maxLength: 60
        postTown:
          type: string
          maxLength: 60
        address3:
          type: string
          maxLength: 60
          nullable: true
        postCode:
          type: string
          maxLength: 12
          nullable: true
        emailAddress:
          type: string
          maxLength: 255
          nullable: true
        telephoneNumber:
          type: string
          maxLength: 25
          nullable: true
        faxNumber:
          type: string
          maxLength: 25
          nullable: true
        purchaserNotes:
          type: string
          maxLength: 1024
          nullable: true
    manufacturerDetails:
      type: object
      description: Used for TRL only
      properties:
        name:
          type: string
          maxLength: 150
        address1:
          type: string
          maxLength: 60
        address2:
          type: string
          maxLength: 60
        postTown:
          type: string
          maxLength: 60
        address3:
          type: string
          maxLength: 60
          nullable: true
        postCode:
          type: string
          maxLength: 12
          nullable: true
        emailAddress:
          type: string
          maxLength: 255
          nullable: true
        telephoneNumber:
          type: string
          maxLength: 25
          nullable: true
        faxNumber:
          type: string
          maxLength: 25
          nullable: true
        manufacturerNotes:
          type: string
          maxLength: 1024
          nullable: true
    axleTyreProperties:
      type: object
      properties:
        tyreSize:
          type: string
          maxLength: 12
          description: 'Used for all vehicle types - PSV, HGV and TRL'
        plyRating:
          type: string
          maxLength: 2
          description: 'Used for all vehicle types - PSV, HGV and TRL'
          nullable: true
        fitmentCode:
          type: string
          enum:
            - double
            - single
          description: 'Used for all vehicle types - PSV, HGV and TRL'
        dataTrAxles:
          type: number
          maximum: 999
          description: 'Used for all vehicle types - PSV, HGV and TRL'
          nullable: true
        speedCategorySymbol:
          type: string
          enum:
            - a7
            - a8
            - b
            - c
            - d
            - e
            - f
            - g
            - j
            - k
            - l
            - m
            - n
            - p
            - q
          description: Used only for PSV
        tyreCode:
          type: number
          maximum: 9999
          description: 'Used for all vehicle types - PSV, HGV and TRL'
    axleBrakeProperties:
      type: object
      description: Used only for TRL
      properties:
        brakeActuator:
          type: number
          maximum: 999
          nullable: true
        leverLength:
          type: number
          maximum: 999
          nullable: true
        springBrakeParking:
          type: boolean
          nullable: true
    completeTechRecordDB:
      type: object
      description: the Tech objects as they
      additionalProperties: false
      properties:
        systemNumber:
          type: string
          description: It defines the composed primary key, in combination with "vin".
        partialVin:
          type: string
        primaryVrm:
          type: string
        secondaryVrms:
          type: array
          nullable: true
          items:
            type: string
            nullable: true
        vin:
          type: string
          minLength: 1
          maxLength: 21
          description: 'Used for all vehicle types - PSV, HGV, TRL, car, lgv, motorcycle'
        trailerId:
          type: string
          maxLength: 8
          description: Used only for TRL
        techRecord:
          $ref: '#/components/schemas/techRecords'
    amendTechRecordVinPost:
      type: object
      description: POST request body for amend VIN request.
      additionalProperties: false
      properties:
        msUserDetails:
          $ref: '#/components/schemas/msUserDetails'
        newVin:
          description: new vehicle identification number
          type: string
          nullable: false
      required:
        - msUserDetails
        - newVin
    msUserDetails:
      description: Authenticated user details
      type: object
      additionalProperties: false
      properties:
        msUser:
          type: string
        msOid:
          type: string
      required:
          - msUser
          - msOid
security:
  - OAuth2:
      - read
      - write
servers:
  - url: 'https://url/api/v1'
